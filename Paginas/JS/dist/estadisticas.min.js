"use strict";var grafica,canvas=document.getElementById("grafica"),ctx=canvas.getContext("2d"),paletas={"a単o":["#7d6df6","#ff7070"],mes:["#6dc8f6","#ff9b9b"],dia:["#ffd766","#ff8a8a"]};function mostrarLoader(){ctx.clearRect(0,0,canvas.width,canvas.height),ctx.font="16px Poppins",ctx.fillStyle="#999",ctx.textAlign="center",ctx.fillText("Cargando...",canvas.width/2,canvas.height/2)}function obtenerDatos(){var e,a,n=arguments;return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:return e=0<n.length&&void 0!==n[0]?n[0]:"a単o",t.prev=1,t.next=4,regeneratorRuntime.awrap(fetch("../PHP/datos_estadisticas.php?periodo=".concat(e)));case 4:if((a=t.sent).ok){t.next=7;break}throw new Error("Error al obtener datos del servidor");case 7:return t.next=9,regeneratorRuntime.awrap(a.json());case 9:return t.abrupt("return",t.sent);case 12:return t.prev=12,t.t0=t.catch(1),console.error("Error en obtenerDatos():",t.t0),t.abrupt("return",[]);case 16:case"end":return t.stop()}},null,null,[[1,12]])}function crearGrafica(){var e,a,n,r,o,c,i,s=arguments;return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:return e=0<s.length&&void 0!==s[0]?s[0]:"a単o",canvas.style.opacity=0,setTimeout(function(){return canvas.style.opacity=1},300),mostrarLoader(),t.next=6,regeneratorRuntime.awrap(obtenerDatos(e));case 6:if(a=t.sent,n=a.find(function(t){return"CLIENTE"===t.tipo})||{total:0},r=a.find(function(t){return"VISITANTE"===t.tipo})||{total:0},o=["CLIENTE","VISITANTE"],c=[parseInt(n.total),parseInt(r.total)],document.getElementById("infoCliente").textContent="".concat(n.total," turnos"),document.getElementById("infoVisitante").textContent="".concat(r.total," turnos"),0===c[0]&&0===c[1])return ctx.clearRect(0,0,canvas.width,canvas.height),ctx.font="18px Poppins",ctx.fillStyle="#555",ctx.textAlign="center",ctx.fillText("Sin datos disponibles",canvas.width/2,canvas.height/2),t.abrupt("return");t.next=20;break;case 20:i=paletas[e]||paletas["a単o"],grafica&&grafica.destroy(),grafica=new Chart(ctx,{type:"doughnut",data:{labels:o,datasets:[{data:c,backgroundColor:i,borderWidth:0}]},options:{cutout:"60%",animation:{animateScale:!0,animateRotate:!0,duration:1200,easing:"easeOutQuart"},plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(t){return"".concat(t.label,": ").concat(t.raw," turnos")}}}}}});case 23:case"end":return t.stop()}})}function actualizarGrafica(t){crearGrafica(t)}Chart.register({id:"centerText",afterDraw:function(t){var e=t.ctx,a=t.chartArea,n=(a.width,a.height,t.config.data.datasets[0].data.reduce(function(t,e){return t+e},0));e.save(),e.font="bold 22px Poppins",e.fillStyle="#444",e.textAlign="center",e.fillText("".concat(n," Turnos"),t.width/2,t.height/2+8),e.restore()}}),document.addEventListener("DOMContentLoaded",function(){crearGrafica()});
//# sourceMappingURL=estadisticas.min.js.map
